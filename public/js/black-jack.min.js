var App=function(e,t,i){"use strict";function n(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var s=n(t);function a(e){const t={};for(const i in e)Array.isArray(e[i])?t[i]=e[i].slice(0):t[i]=e[i];return t}function o(e,t,i){if(!e||"number"==typeof e)return i;if(Object.prototype.hasOwnProperty.call(e,t))return e[t.toString()];if(-1!==t.toString().indexOf(".")){const n=t.toString().split(".");let s=e,a=i;for(let e=0;e<n.length;e++){if(!Object.prototype.hasOwnProperty.call(s,n[e])){a=i;break}a=s[n[e]],s=s[n[e]]}return a}return i}function r(e,t){const i=a(e);for(const e in t)Object.prototype.hasOwnProperty.call(i,e)||(i[e]=t[e]);return i}function d(e){const t=[];if(null==e&&(e={}),e.prefix=o(e,"prefix",""),e.suffix=o(e,"suffix",""),e.pad=o(e,"pad",5),e.start=o(e,"start",0),e.stop=o(e,"stop",0),e.start<=e.stop)for(let i=e.start;i<=e.stop;i++){let n=e.prefix;const s=e.pad-String(i).length;if(s>0)for(let e=0;e<s;e++)n=n.concat("0");n+=String(i),n+=e.suffix,t.push(n)}else for(let i=e.start;i>=e.stop;i--){let n=e.prefix;const s=e.pad-String(i).length;if(s>0)for(let e=0;e<s;e++)n=n.concat("0");n+=String(i),n+=e.suffix,t.push(n)}return t}function l(e=0,t=100){return Math.floor(Math.random()*(t-e+1)+e)}function h(e){let t=e.split("."),i=null;if(t.length>0){i=globalThis[t[0]];for(var n=1;n<t.length;n++)i=i[t[n]]}return i}var u=Object.freeze({__proto__:null,Clone:a,GetValue:o,Merge:r,Pad:d,RandomNumber:l,StringToClass:h});class c extends s.utils.EventEmitter{constructor(e,t){if(super(),this._key="",this.data={},this._size=0,this._key=t??`Storage-${c.count}`,c.count++,void 0===e&&(e=this._key),"string"==typeof e&&this.load(e),"object"==typeof e&&!Array.isArray(e))for(const t in e)this.set(t,e[t])}query(e){const t={};for(const i in this.data)Object.prototype.hasOwnProperty.call(this.data,i)&&i.match(e)&&(t[i]=this.data[i]);return t}set(e,t){if("object"==typeof e){Object.keys(e).forEach((t=>{this.set(t,e[t])}),this)}else if(-1!==e.indexOf(".")){const i=e.split(".");let n=this.data,s=this.data,o=this.data;for(let e=0;e<i.length;e++)void 0===o[i[e]]&&(0===e&&this._size++,o[i[e]]={}),o=o[i[e]];for(let e=0;e<i.length&&Object.prototype.hasOwnProperty.call(n,i[e]);e++)s=n,n=n[i[e]];if(void 0===s[i[i.length-1]])s[i[i.length-1]]=t,this.emit("setdata",i[i.length-1],a(s[i[i.length-1]]));else{const e=s[i[i.length-1]];s[i[i.length-1]]=t,this.emit("changedata",i[i.length-1],a(s[i[i.length-1]]),e)}}else{const i=this.has(e);i||this._size++;const n=this.data[e];this.data[e]=t,i?this.emit("changedata",e,a(this.data[e]),n):this.emit("setdata",e,a(this.data[e]))}return this}get(e,t=null){if(-1!==e.indexOf(".")){const i=e.split(".");let n=this.data,s=t;for(let e=0;e<i.length;e++){if(!Object.prototype.hasOwnProperty.call(n,i[e])){s=t;break}s=n[i[e]],n=n[i[e]]}return"object"!=typeof s||Array.isArray(s)?s:a(s)}return this.has(e)?"object"!=typeof this.data[e]||Array.isArray(this.data[e])?this.data[e]:a(this.data[e]):t}getAll(){const e={};for(const t in this.data)Object.prototype.hasOwnProperty.call(this.data,t)&&(e[t]=this.data[t]);return e}has(e){return Object.prototype.hasOwnProperty.call(this.data,e)}delete(e,t=!1){if(this.has(e)){const i=this.data[e];delete this.data[e],this._size--,this.emit("removedata",e,i),t&&this.save()}return this}clear(e=!1){return Object.keys(this.data).forEach((e=>{delete this.data[e]}),this),e&&this.unload(),this._size=0,this}keys(){return Object.keys(this.data)}values(){const e=[];for(const t in this.data)Object.prototype.hasOwnProperty.call(this.data,t)&&e.push(this.data[t]);return e}dump(){console.group(`${this._key} Size: ${this._size}`);for(const e in this.data)Object.prototype.hasOwnProperty.call(this.data,e)&&console.log(e,this.data[e]);console.groupEnd()}each(e){for(const t in this.data)if(Object.prototype.hasOwnProperty.call(this.data,t)&&!1===e(t,this.data[t]))break;return this}contains(e){for(const t in this.data)if(Object.prototype.hasOwnProperty.call(this.data,t)&&this.data[t]===e)return!0;return!1}merge(e,t=!1){void 0===t&&(t=!1);const i=this.data,n=e.data;for(const e in n)Object.prototype.hasOwnProperty.call(i,e)&&t?i[e]=n[e]:this.set(e,n[e]);return this}hasLocalRecord(e){return null!==window.localStorage&&(e=void 0!==e?e:this._key,null!==window.localStorage.getItem(e))}load(e){if(null!==window.localStorage){e=void 0!==e?e:this._key;let t=window.localStorage.getItem(e);null==t&&(t="{}");const i=JSON.parse(t);if("object"==typeof i)if(Array.isArray(i)){const e=i.length;for(let t=0;t<e;t++){const e=i[t];e&&this.set(e[0],e[1])}}else Object.keys(i).forEach((e=>{this.set(e,i[e])}),this)}else console.warn("Local storage not supported");return this}save(){return null!==window.localStorage?window.localStorage.setItem(this._key,JSON.stringify(this.data)):console.warn("Local storage not supported"),this}unload(){return null!==window.localStorage?window.localStorage.removeItem(this._key):console.warn("Local storage not supported"),this}destroy(){this.clear(),this.removeAllListeners()}get size(){return this._size}get key(){return this._key}}c.count=0;class p{constructor(e){this.data=null,this.free=!1,this.data=e}}class _{constructor(e,t=(e=>e),i=100){this.poolArray=[],this.constructorFunction=null,this.resetFunction=null,this.constructorFunction=e,this.resetFunction=t,this.increase(i)}increase(e=1){e<=0&&(e=1);for(let t=0;t<e;t++)this.create()}decrease(e=1){e<=0&&(e=1);for(let t=0;t<this.poolArray.length&&(!this.poolArray[t]||!this.poolArray[t].free||(this.poolArray.splice(t,1),t--,0!==--e));t++);}create(){const e=this.resetFunction(this.constructorFunction()),t=new p(e);return this.poolArray.push(t),t}get(){for(let e=0;e<this.poolArray.length;e++)if(this.poolArray[e].free)return this.poolArray[e].free=!1,this.poolArray[e];const e=this.create();return e.free=!1,e}release(e){e.free=!0,this.resetFunction(e.data)}get size(){return this.poolArray.length}get inUseSize(){return this.size-this.freeSize}get freeSize(){let e=0;for(let t=0;t<this.poolArray.length;t++)this.poolArray[t].free&&e++;return e}}var f=Object.freeze({__proto__:null,DataManager:c,ObjectPool:_,ObjectPoolMember:p});let g=class{static init(e){e=Object.assign({data:{}},e),Object.defineProperty(this,"data",{set(e){this._data=e},get(){return this._data}}),this._data=null,this.data=new c(e.data,"Game-Storage")}static destroy(){this._data&&this._data.destroy()}};g.extension=s.ExtensionType.Application,s.extensions.add(g);var m,y,b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},v={};
/*!
     *  howler.js v2.2.3
     *  howlerjs.com
     *
     *  (c) 2013-2020, James Simpson of GoldFire Studios
     *  goldfirestudios.com
     *
     *  MIT License
     */
!function(e){!function(){var t=function(){this.init()};t.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||i;if(e=parseFloat(e),t.ctx||h(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var s=t._howls[n]._getSoundIds(),a=0;a<s.length;a++){var o=t._howls[n]._soundById(s[a]);o&&o._node&&(o._node.volume=o._volume*e)}return t}return t._volume},mute:function(e){var t=this||i;t.ctx||h(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,i.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var s=t._howls[n]._getSoundIds(),a=0;a<s.length;a++){var o=t._howls[n]._soundById(s[a]);o&&o._node&&(o._node.muted=!!e||o._muted)}return t},stop:function(){for(var e=this||i,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||i,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,h()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),s=e._navigator?e._navigator.userAgent:"",a=s.match(/OPR\/([0-6].)/g),o=a&&parseInt(a[0].split("/")[1],10)<33,r=-1!==s.indexOf("Safari")&&-1===s.indexOf("Chrome"),d=s.match(/Version\/(.*?) /),l=r&&d&&parseInt(d[1],10)<15;return e._codecs={mp3:!(o||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(l||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(l||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(i){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,e._releaseHtml5Audio(n)}catch(i){e.noAudio=!0;break}for(var s=0;s<e._howls.length;s++)if(!e._howls[s]._webAudio)for(var a=e._howls[s]._getSoundIds(),o=0;o<a.length;o++){var r=e._howls[s]._soundById(a[o]);r&&r._node&&!r._node._unlocked&&(r._node._unlocked=!0,r._node.load())}e._autoResume();var d=e.ctx.createBufferSource();d.buffer=e._scratchBuffer,d.connect(e.ctx.destination),void 0===d.start?d.noteOn(0):d.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),d.onended=function(){d.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||i;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&i.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&i.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var i=new t,n=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(e){var t=this;return i.ctx||h(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=i.usingWebAudio&&!t._html5,void 0!==i.ctx&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(i.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var a,r;if(e._format&&e._format[n])a=e._format[n];else{if("string"!=typeof(r=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(a=/^data:audio\/([^;,]+);/i.exec(r))||(a=/\.([^.]+)$/.exec(r.split("?",1)[0])),a&&(a=a[1].toLowerCase())}if(a||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),a&&i.codecs(a)){t=e._src[n];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new s(e),e._webAudio&&o(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,s=null;if("number"==typeof e)s=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var a=0,o=0;o<n._sounds.length;o++)n._sounds[o]._paused&&!n._sounds[o]._ended&&(a++,s=n._sounds[o]._id);1===a?e=null:s=null}}var r=s?n._soundById(s):n._inactiveSound();if(!r)return null;if(s&&!e&&(e=r._sprite||"__default"),"loaded"!==n._state){r._sprite=e,r._ended=!1;var d=r._id;return n._queue.push({event:"play",action:function(){n.play(d)}}),d}if(s&&!r._paused)return t||n._loadQueue("play"),r._id;n._webAudio&&i._autoResume();var l=Math.max(0,r._seek>0?r._seek:n._sprite[e][0]/1e3),h=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-l),u=1e3*h/Math.abs(r._rate),c=n._sprite[e][0]/1e3,p=(n._sprite[e][0]+n._sprite[e][1])/1e3;r._sprite=e,r._ended=!1;var _=function(){r._paused=!1,r._seek=l,r._start=c,r._stop=p,r._loop=!(!r._loop&&!n._sprite[e][2])};if(!(l>=p)){var f=r._node;if(n._webAudio){var g=function(){n._playLock=!1,_(),n._refreshBuffer(r);var e=r._muted||n._muted?0:r._volume;f.gain.setValueAtTime(e,i.ctx.currentTime),r._playStart=i.ctx.currentTime,void 0===f.bufferSource.start?r._loop?f.bufferSource.noteGrainOn(0,l,86400):f.bufferSource.noteGrainOn(0,l,h):r._loop?f.bufferSource.start(0,l,86400):f.bufferSource.start(0,l,h),u!==1/0&&(n._endTimers[r._id]=setTimeout(n._ended.bind(n,r),u)),t||setTimeout((function(){n._emit("play",r._id),n._loadQueue()}),0)};"running"===i.state&&"interrupted"!==i.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(r._id))}else{var m=function(){f.currentTime=l,f.muted=r._muted||n._muted||i._muted||f.muted,f.volume=r._volume*i.volume(),f.playbackRate=r._rate;try{var s=f.play();if(s&&"undefined"!=typeof Promise&&(s instanceof Promise||"function"==typeof s.then)?(n._playLock=!0,_(),s.then((function(){n._playLock=!1,f._unlocked=!0,t?n._loadQueue():n._emit("play",r._id)})).catch((function(){n._playLock=!1,n._emit("playerror",r._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),r._ended=!0,r._paused=!0}))):t||(n._playLock=!1,_(),n._emit("play",r._id)),f.playbackRate=r._rate,f.paused)return void n._emit("playerror",r._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||r._loop?n._endTimers[r._id]=setTimeout(n._ended.bind(n,r),u):(n._endTimers[r._id]=function(){n._ended(r),f.removeEventListener("ended",n._endTimers[r._id],!1)},f.addEventListener("ended",n._endTimers[r._id],!1))}catch(e){n._emit("playerror",r._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===f.src&&(f.src=n._src,f.load());var y=window&&window.ejecta||!f.readyState&&i._navigator.isCocoonJS;if(f.readyState>=3||y)m();else{n._playLock=!0,n._state="loading";var b=function(){n._state="loaded",m(),f.removeEventListener(i._canPlayEvent,b,!1)};f.addEventListener(i._canPlayEvent,b,!1),n._clearTimer(r._id)}}return r._id}n._ended(r)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),n=0;n<i.length;n++){t._clearTimer(i[n]);var s=t._soundById(i[n]);if(s&&!s._paused&&(s._seek=t.seek(i[n]),s._rateSeek=0,s._paused=!0,t._stopFade(i[n]),s._node))if(t._webAudio){if(!s._node.bufferSource)continue;void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),t._cleanBuffer(s._node)}else isNaN(s._node.duration)&&s._node.duration!==1/0||s._node.pause();arguments[1]||t._emit("pause",s?s._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var n=i._getSoundIds(e),s=0;s<n.length;s++){i._clearTimer(n[s]);var a=i._soundById(n[s]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,i._stopFade(n[s]),a._node&&(i._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),i._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&i._clearSound(a._node))),t||i._emit("stop",a._id))}return i},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var s=n._getSoundIds(t),a=0;a<s.length;a++){var o=n._soundById(s[a]);o&&(o._muted=e,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(e?0:o._volume,i.ctx.currentTime):o._node&&(o._node.muted=!!i._muted||e),n._emit("mute",o._id))}return n},volume:function(){var e,t,n,s=this,a=arguments;if(0===a.length)return s._volume;if(1===a.length||2===a.length&&void 0===a[1]?s._getSoundIds().indexOf(a[0])>=0?t=parseInt(a[0],10):e=parseFloat(a[0]):a.length>=2&&(e=parseFloat(a[0]),t=parseInt(a[1],10)),!(void 0!==e&&e>=0&&e<=1))return(n=t?s._soundById(t):s._sounds[0])?n._volume:0;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"volume",action:function(){s.volume.apply(s,a)}}),s;void 0===t&&(s._volume=e),t=s._getSoundIds(t);for(var o=0;o<t.length;o++)(n=s._soundById(t[o]))&&(n._volume=e,a[2]||s._stopFade(t[o]),s._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,i.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*i.volume()),s._emit("volume",n._id));return s},fade:function(e,t,n,s){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"fade",action:function(){a.fade(e,t,n,s)}}),a;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),a.volume(e,s);for(var o=a._getSoundIds(s),r=0;r<o.length;r++){var d=a._soundById(o[r]);if(d){if(s||a._stopFade(o[r]),a._webAudio&&!d._muted){var l=i.ctx.currentTime,h=l+n/1e3;d._volume=e,d._node.gain.setValueAtTime(e,l),d._node.gain.linearRampToValueAtTime(t,h)}a._startFadeInterval(d,e,t,n,o[r],void 0===s)}}return a},_startFadeInterval:function(e,t,i,n,s,a){var o=this,r=t,d=i-t,l=Math.abs(d/.01),h=Math.max(4,l>0?n/l:n),u=Date.now();e._fadeTo=i,e._interval=setInterval((function(){var s=(Date.now()-u)/n;u=Date.now(),r+=d*s,r=Math.round(100*r)/100,r=d<0?Math.max(i,r):Math.min(i,r),o._webAudio?e._volume=r:o.volume(r,e._id,!0),a&&(o._volume=r),(i<t&&r<=i||i>t&&r>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,o.volume(i,e._id),o._emit("fade",e._id))}),h)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,i,n=this,s=arguments;if(0===s.length)return n._loop;if(1===s.length){if("boolean"!=typeof s[0])return!!(i=n._soundById(parseInt(s[0],10)))&&i._loop;e=s[0],n._loop=e}else 2===s.length&&(e=s[0],t=parseInt(s[1],10));for(var a=n._getSoundIds(t),o=0;o<a.length;o++)(i=n._soundById(a[o]))&&(i._loop=e,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop,n.playing(a[o])&&(n.pause(a[o],!0),n.play(a[o],!0)))));return n},rate:function(){var e,t,n,s=this,a=arguments;if(0===a.length)t=s._sounds[0]._id;else if(1===a.length){s._getSoundIds().indexOf(a[0])>=0?t=parseInt(a[0],10):e=parseFloat(a[0])}else 2===a.length&&(e=parseFloat(a[0]),t=parseInt(a[1],10));if("number"!=typeof e)return(n=s._soundById(t))?n._rate:s._rate;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"rate",action:function(){s.rate.apply(s,a)}}),s;void 0===t&&(s._rate=e),t=s._getSoundIds(t);for(var o=0;o<t.length;o++)if(n=s._soundById(t[o])){s.playing(t[o])&&(n._rateSeek=s.seek(t[o]),n._playStart=s._webAudio?i.ctx.currentTime:n._playStart),n._rate=e,s._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,i.ctx.currentTime):n._node&&(n._node.playbackRate=e);var r=s.seek(t[o]),d=1e3*((s._sprite[n._sprite][0]+s._sprite[n._sprite][1])/1e3-r)/Math.abs(n._rate);!s._endTimers[t[o]]&&n._paused||(s._clearTimer(t[o]),s._endTimers[t[o]]=setTimeout(s._ended.bind(s,n),d)),s._emit("rate",n._id)}return s},seek:function(){var e,t,n=this,s=arguments;if(0===s.length)n._sounds.length&&(t=n._sounds[0]._id);else if(1===s.length){n._getSoundIds().indexOf(s[0])>=0?t=parseInt(s[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(s[0]))}else 2===s.length&&(e=parseFloat(s[0]),t=parseInt(s[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,s)}}),n;var a=n._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var o=n.playing(t)?i.ctx.currentTime-a._playStart:0,r=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(r+o*Math.abs(a._rate))}return a._node.currentTime}var d=n.playing(t);d&&n.pause(t,!0),a._seek=e,a._ended=!1,n._clearTimer(t),n._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=e);var l=function(){d&&n.play(t,!0),n._emit("seek",t)};if(d&&!n._webAudio){var h=function(){n._playLock?setTimeout(h,0):l()};setTimeout(h,0)}else l()}return n},playing:function(e){var t=this;if("number"==typeof e){var i=t._soundById(e);return!!i&&!i._paused}for(var n=0;n<t._sounds.length;n++)if(!t._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this,i=t._duration,n=t._soundById(e);return n&&(i=t._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(i._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),i._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var s=i._howls.indexOf(e);s>=0&&i._howls.splice(s,1);var o=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===e._src||e._src.indexOf(i._howls[n]._src)>=0){o=!1;break}return a&&o&&delete a[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,n){var s=this["_on"+e];return"function"==typeof t&&s.push(n?{id:i,fn:t,once:n}:{id:i,fn:t}),this},off:function(e,t,i){var n=this,s=n["_on"+e],a=0;if("number"==typeof t&&(i=t,t=null),t||i)for(a=0;a<s.length;a++){var o=i===s[a].id;if(t===s[a].fn&&o||!t&&o){s.splice(a,1);break}}else if(e)n["_on"+e]=[];else{var r=Object.keys(n);for(a=0;a<r.length;a++)0===r[a].indexOf("_on")&&Array.isArray(n[r[a]])&&(n[r[a]]=[])}return n},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var n=this,s=n["_on"+e],a=s.length-1;a>=0;a--)s[a].id&&s[a].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(n,s[a].fn),0),s[a].once&&n.off(e,s[a].fn,s[a].id));return n._loadQueue(e),n},_loadQueue:function(e){var t=this;if(t._queue.length>0){var i=t._queue[0];i.event===e&&(t._queue.shift(),t._loadQueue()),e||i.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var s=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&s&&t.stop(e._id,!0).play(e._id),t._webAudio&&s){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),a)}return t._webAudio&&!s&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),i._autoSuspend()),t._webAudio||s||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var i=t._soundById(e);i&&i._node&&i._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,i=0;i<t._sounds.length;i++)if(e===t._sounds[i]._id)return t._sounds[i];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new s(e)},_drain:function(){var e=this,t=e._pool,i=0,n=0;if(!(e._sounds.length<t)){for(n=0;n<e._sounds.length;n++)e._sounds[n]._ended&&i++;for(n=e._sounds.length-1;n>=0;n--){if(i<=t)return;e._sounds[n]._ended&&(e._webAudio&&e._sounds[n]._node&&e._sounds[n]._node.disconnect(0),e._sounds.splice(n,1),i--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=a[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),this},_cleanBuffer:function(e){var t=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=i._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(e){this._parent=e,this.init()};s.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=i._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),e._node.gain.setValueAtTime(n,i.ctx.currentTime),e._node.paused=!0,e._node.connect(i.masterGain)):i.noAudio||(e._node=i._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(i._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=n*i.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(i._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var a={},o=function(e){var t=e._src;if(a[t])return e._duration=a[t].duration,void l(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),n=new Uint8Array(i.length),s=0;s<i.length;++s)n[s]=i.charCodeAt(s);d(n.buffer,e)}else{var o=new XMLHttpRequest;o.open(e._xhr.method,t,!0),o.withCredentials=e._xhr.withCredentials,o.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){o.setRequestHeader(t,e._xhr.headers[t])})),o.onload=function(){var t=(o.status+"")[0];"0"===t||"2"===t||"3"===t?d(o.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete a[t],e.load())},r(o)}},r=function(e){try{e.send()}catch(t){e.onerror()}},d=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},s=function(e){e&&t._sounds.length>0?(a[t._src]=e,l(t,e)):n()};"undefined"!=typeof Promise&&1===i.ctx.decodeAudioData.length?i.ctx.decodeAudioData(e).then(s).catch(n):i.ctx.decodeAudioData(e,s,n)},l=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},h=function(){if(i.usingWebAudio){try{"undefined"!=typeof AudioContext?i.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch(e){i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),t=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var s=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!s&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};e.Howler=i,e.Howl=n,void 0!==b?(b.HowlerGlobal=t,b.Howler=i,b.Howl=n,b.Sound=s):"undefined"!=typeof window&&(window.HowlerGlobal=t,window.Howler=i,window.Howl=n,window.Sound=s)}(),
/*!
    	 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
    	 *  
    	 *  howler.js v2.2.3
    	 *  howlerjs.com
    	 *
    	 *  (c) 2013-2020, James Simpson of GoldFire Studios
    	 *  goldfirestudios.com
    	 *
    	 *  MIT License
    	 */
function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var i=t._howls.length-1;i>=0;i--)t._howls[i].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,i){var n=this;return n.ctx&&n.ctx.listener?(t="number"!=typeof t?n._pos[1]:t,i="number"!=typeof i?n._pos[2]:i,"number"!=typeof e?n._pos:(n._pos=[e,t,i],void 0!==n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(e,t,i,n,s,a){var o=this;if(!o.ctx||!o.ctx.listener)return o;var r=o._orientation;return t="number"!=typeof t?r[1]:t,i="number"!=typeof i?r[2]:i,n="number"!=typeof n?r[3]:n,s="number"!=typeof s?r[4]:s,a="number"!=typeof a?r[5]:a,"number"!=typeof e?r:(o._orientation=[e,t,i,n,s,a],void 0!==o.ctx.listener.forwardX?(o.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(e,t,i,n,s,a),o)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var i=this;return i._orientation=t.orientation||[1,0,0],i._stereo=t.stereo||null,i._pos=t.pos||null,i._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},i._onstereo=t.onstereo?[{fn:t.onstereo}]:[],i._onpos=t.onpos?[{fn:t.onpos}]:[],i._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var s=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var a=n._getSoundIds(i),o=0;o<a.length;o++){var r=n._soundById(a[o]);if(r){if("number"!=typeof e)return r._stereo;r._stereo=e,r._pos=[e,0,0],r._node&&(r._pannerAttr.panningModel="equalpower",r._panner&&r._panner.pan||t(r,s),"spatial"===s?void 0!==r._panner.positionX?(r._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):r._panner.setPosition(e,0,0):r._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",r._id)}}return n},Howl.prototype.pos=function(e,i,n,s){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"pos",action:function(){a.pos(e,i,n,s)}}),a;if(i="number"!=typeof i?0:i,n="number"!=typeof n?-.5:n,void 0===s){if("number"!=typeof e)return a._pos;a._pos=[e,i,n]}for(var o=a._getSoundIds(s),r=0;r<o.length;r++){var d=a._soundById(o[r]);if(d){if("number"!=typeof e)return d._pos;d._pos=[e,i,n],d._node&&(d._panner&&!d._panner.pan||t(d,"spatial"),void 0!==d._panner.positionX?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):d._panner.setPosition(e,i,n)),a._emit("pos",d._id)}}return a},Howl.prototype.orientation=function(e,i,n,s){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"orientation",action:function(){a.orientation(e,i,n,s)}}),a;if(i="number"!=typeof i?a._orientation[1]:i,n="number"!=typeof n?a._orientation[2]:n,void 0===s){if("number"!=typeof e)return a._orientation;a._orientation=[e,i,n]}for(var o=a._getSoundIds(s),r=0;r<o.length;r++){var d=a._soundById(o[r]);if(d){if("number"!=typeof e)return d._orientation;d._orientation=[e,i,n],d._node&&(d._panner||(d._pos||(d._pos=a._pos||[0,0,-.5]),t(d,"spatial")),void 0!==d._panner.orientationX?(d._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),d._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):d._panner.setOrientation(e,i,n)),a._emit("orientation",d._id)}}return a},Howl.prototype.pannerAttr=function(){var e,i,n,s=this,a=arguments;if(!s._webAudio)return s;if(0===a.length)return s._pannerAttr;if(1===a.length){if("object"!=typeof a[0])return(n=s._soundById(parseInt(a[0],10)))?n._pannerAttr:s._pannerAttr;e=a[0],void 0===i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),s._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:s._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:s._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:s._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:s._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:s._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:s._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:s._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:s._panningModel})}else 2===a.length&&(e=a[0],i=parseInt(a[1],10));for(var o=s._getSoundIds(i),r=0;r<o.length;r++)if(n=s._soundById(o[r])){var d=n._pannerAttr;d={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:d.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:d.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:d.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:d.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:d.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:d.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:d.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:d.panningModel};var l=n._panner;l?(l.coneInnerAngle=d.coneInnerAngle,l.coneOuterAngle=d.coneOuterAngle,l.coneOuterGain=d.coneOuterGain,l.distanceModel=d.distanceModel,l.maxDistance=d.maxDistance,l.refDistance=d.refDistance,l.rolloffFactor=d.rolloffFactor,l.panningModel=d.panningModel):(n._pos||(n._pos=s._pos||[0,0,-.5]),t(n,"spatial"))}return s},Sound.prototype.init=function(e){return function(){var t=this,i=t._parent;t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,e.call(this),t._stereo?i.stereo(t._stereo):t._pos&&i.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,i=t._parent;return t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,t._stereo?i.stereo(t._stereo):t._pos?i.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,i._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}(v);class w{static init(e){if(e=Object.assign({sounds:[]},e),Object.defineProperty(this,"sound",{set(e){this._sound=e},get(){return this._sound}}),v.Howler.sounds={},v.Howler.add=function(e,t){const i=new v.Howl(t);return this.sounds[e]=i,i},v.Howler.get=function(e){return this.sounds[e]},v.Howler.has=function(e){return void 0!==this.sounds[e]},v.Howler.destroy=function(){this.unload()},this._sound=null,this.sound=v.Howler,e.sounds){Object.keys(e.sounds).forEach((t=>{v.Howler.add(t,e.sounds[t])}))}}static destroy(){this._sound&&this._sound.destroy()}}w.extension=s.ExtensionType.Application,s.extensions.add(w),function(e){e[e.LEFT_TOP=0]="LEFT_TOP",e[e.LEFT_CENTER=1]="LEFT_CENTER",e[e.LEFT_BOTTOM=2]="LEFT_BOTTOM",e[e.CENTER_TOP=3]="CENTER_TOP",e[e.CENTER=4]="CENTER",e[e.CENTER_BOTTOM=5]="CENTER_BOTTOM",e[e.RIGHT_TOP=6]="RIGHT_TOP",e[e.RIGHT_CENTER=7]="RIGHT_CENTER",e[e.RIGHT_BOTTOM=8]="RIGHT_BOTTOM"}(m||(m={})),function(e){e.LANDSCAPE="landscape-primary",e.PORTRAIT="portrait-primary"}(y||(y={}));class A{static init(e){Object.defineProperty(this,"safeWidth",{set(e){this._safeWidth=e,this.resize()},get(){return this._safeWidth}}),Object.defineProperty(this,"safeHeight",{set(e){this._safeHeight=e,this.resize()},get(){return this._safeHeight}}),Object.defineProperty(this,"align",{set(e){this._align=e,this.checkAlign()},get(){return this._align}}),Object.defineProperty(this,"orientation",{get(){return this.screen.width>=this.screen.height?y.LANDSCAPE:y.PORTRAIT}}),Object.defineProperty(this,"left",{get(){return this._left}}),Object.defineProperty(this,"right",{get(){return this._right}}),Object.defineProperty(this,"top",{get(){return this._top}}),Object.defineProperty(this,"bottom",{get(){return this._bottom}}),this.resize=()=>{const e=this;let t,i,n,s;if(e.resizeTo||(e.resizeTo=globalThis.document.body),e.cancelResize(),e.resizeTo===globalThis.window)n=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:t,clientHeight:i}=e.resizeTo;n=t,s=i}this._initialHeight/this._initialWidth>s/n?this._safeHeight/this._initialWidth>s/n?(i=s*this._initialHeight/this._safeHeight,t=i*this._initialWidth/this._initialHeight):(t=n,i=t*this._initialHeight/this._initialWidth):this._initialHeight/this._safeWidth>s/n?(i=s,t=i*this._initialWidth/this._initialHeight):(t=n*this._initialWidth/this._safeWidth,i=t*this._initialHeight/this._initialWidth),t=Math.round(t),i=Math.round(i),e.renderer.resize(t,i),e.render(),this.checkAlign();const a=Math.round(t/this._initialWidth*1e3)/1e3,o=Math.round(i/this._initialHeight*1e3)/1e3;e.stage.scale.set(a,o)},this.checkAlign=()=>{const e=this;let t=0,i=0,n=0,s=0;const a=e.view.parentElement?e.view.parentElement:globalThis.document.body,o=e.screen.width/e.renderer.resolution,r=e.screen.height/e.renderer.resolution,d=a.clientWidth,l=a.clientHeight;switch(this._align){case m.LEFT_TOP:t=0,i=Math.round(d-o),n=0,s=Math.round(l-r);break;case m.LEFT_CENTER:t=0,i=Math.round(d-o),n=Math.round((l-r)/2),s=n;break;case m.LEFT_BOTTOM:t=0,i=Math.round(d-o),n=Math.round(l-r),s=0;break;case m.CENTER_TOP:t=Math.round((d-o)/2),i=t,n=0,s=Math.round(l-r);break;case m.CENTER:t=Math.round((d-o)/2),i=t,n=Math.round((l-r)/2),s=n;break;case m.CENTER_BOTTOM:t=Math.round((d-o)/2),i=t,n=Math.round(l-r),s=0;break;case m.RIGHT_TOP:t=Math.round(d-o),i=0,n=0,s=Math.round(l-r);break;case m.RIGHT_CENTER:t=Math.round(d-o),i=0,n=Math.round((l-r)/2),s=n;break;case m.RIGHT_BOTTOM:t=Math.round(d-o),i=0,n=Math.round(l-r),s=0}a.style.position="absolute",this._left=t,this._top=n,this._right=i,this._bottom=s,a.style.left=`${t}px`,a.style.top=`${n}px`},this._initialWidth=e.width||800,this._initialHeight=e.height||600,this._safeWidth=e.safeWidth||this._initialWidth,this._safeHeight=e.safeHeight||this._initialHeight,this._align=e.align||m.LEFT_TOP,setTimeout(this.resize,100)}static destroy(){this.resize=null}}A.extension=s.ExtensionType.Application,s.extensions.add(A);class x extends s.utils.EventEmitter{constructor(e,t){super(),this.game=e,this._sceneArr=[],this._scenes={},this._current=null,this.game.stage.name="ROOT",void 0!==t&&(Array.isArray(t)||(t=[t]),t.forEach((e=>{this.add(e)}))),this.game.renderer.on("resize",this.onResize,this),this.game.renderer.on("prerender",this.onPrerender,this)}onResize(){this._sceneArr.forEach((e=>{e.isBooted&&e.resize&&e.resize()}))}onPrerender(){const e=this.game.ticker.deltaTime;this._sceneArr.forEach((t=>{t.isBooted&&t.isActive&&(t.emit("preupdate",e),t.update&&t.update(e),t.emit("postupdate",e))}))}has(e){return Object.keys(this._scenes).indexOf(e)>-1}get(e){return this.has(e)?this._scenes[e].instance:null}getConf(e){return this.has(e)?this._scenes[e].conf:null}add(e){this.has(e.key)&&this.remove(e.key),"string"==typeof e.className&&(e.className=h(e.className));const t=new e.className(this,e);return this._scenes[e.key]={conf:e,instance:t},this._sceneArr.push(t),"function"==typeof t.init&&(t.init(),t.emit("init"),this.emit("sceneinit",t.key)),!0===e.active&&this.start(e.key),this}start(e){const t=this.get(e);if(null!==t)if(t.isBooted)t.isSleeping&&this.wakeup(e),t.isActive||this.resume(e);else{if(this._scenes[t.key].conf.bundle){const e=this.getConf(t.key)?.bundle||[],i=[];return e.forEach((e=>{s.Assets.addBundle(e.name,e.assets),i.push(e.name)})),s.Assets.loadBundle(i).then((()=>{t.preload?t.preload().then((()=>{this.createScene(t.key)})):this.createScene(t.key)})),this}if(t.preload)return t.preload().then((()=>{this.createScene(t.key)})),this;this.createScene(t.key)}return this}switch(e,t){const i=this.get(e),n=this.get(t);return i&&n&&i!==n&&(this.sleep(e),n.isSleeping?this.wakeup(t):this.start(t)),this}createScene(e){const t=this.get(e);null!==t&&(t.buildMap(this.getConf(t.key).map),t.create&&(t.create(),t.emit("created"),this.emit("scenecreated",t.key)),t.resize&&(t.resize(),t.emit("resize",this.game.screen.width,this.game.screen.height,this.game.orientation),this.emit("sceneresize",t.key,this.game.screen.width,this.game.screen.height,this.game.orientation)),t.isBooted=!0,this._current=t,this.addToStage(t))}remove(e){const t=this.get(e);return null!==t&&(t.isBooted&&this.stop(e),this.has(e)&&(this.removeFromStage(t),delete this._scenes[e],this._sceneArr.splice(this._sceneArr.indexOf(t),1),t.emit("deleted"),this.emit("scenedeleted",e))),this}stop(e,t){const i=this.get(e);return null!==i&&(this.pause(e),this.sleep(e),this._current===i&&(this._current=null),i.isBooted&&i.destroy(t),i.isBooted=!1,i.emit("stopped"),this.emit("scenestopped",e)),this.remove(e)}pause(e){const t=this.get(e);return null!==t&&t.isBooted&&t.isActive&&(t.isActive=!1,t.emit("paused"),this.emit("scenepaused",e)),this}resume(e){const t=this.get(e);return null!==t&&t.isBooted&&!t.isActive&&(t.isActive=!0,t.emit("resume"),this.emit("sceneresume",e)),this}sleep(e){const t=this.get(e);return null!==t&&t.isBooted&&!t.isSleeping&&(t.isSleeping=!0,t.renderable=!1,t.emit("slept"),this.emit("sceneslept",e)),this}wakeup(e){const t=this.get(e);return null!==t&&t.isBooted&&t.isSleeping&&(t.isSleeping=!1,t.renderable=!0,t.emit("wokeup"),this.emit("scenewokeup",e)),this}bringToTop(e){if(this.has(e)){const t=this.get(e),i=this._sceneArr.indexOf(t);-1!==i&&i<this._sceneArr.length&&(this._sceneArr.splice(i,1),this._sceneArr.push(t),this.reOrderScenes())}return this}sendToBack(e){if(this.has(e)){const t=this.get(e),i=this._sceneArr.indexOf(t);-1!==i&&i>0&&(this._sceneArr.splice(i,1),this._sceneArr.unshift(t),this.reOrderScenes())}return this}destroy(){this._sceneArr.forEach((e=>{this.remove(e.key)}))}reOrderScenes(){for(let e=0;e<this._sceneArr.length;e++)this._sceneArr[e].zIndex=e;this.game.stage.sortChildren()}addToStage(e){this.game.stage.addChild(e),this.reOrderScenes()}removeFromStage(e){this.game.stage.removeChild(e),this.reOrderScenes()}get current(){return this._current}}class T{static init(e){e=Object.assign({scenes:[]},e),Object.defineProperty(this,"scene",{set(e){this._scene=e},get(){return this._scene}}),this._scene=null,this.scene=new x(this,e.scenes)}static destroy(){this._scene&&this._scene.destroy()}}T.extension=s.ExtensionType.Application,s.extensions.add(T);var S=Object.freeze({__proto__:null,HowlerPlugin:w,ScalePlugin:A,SceneDataPlugin:g,SceneManagerPlugin:T});class k{static init(e){e=Object.assign({data:{}},e),Object.defineProperty(this,"data",{set(e){this._data=e},get(){return this._data}}),this._data=null,this.data=new c(e.data,`${e.key}-Storage`)}static destroy(){this._data&&this._data.destroy()}}k.extension="scene",s.extensions.add(k);var C,P=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return this.None(e)},Out:function(e){return this.None(e)},InOut:function(e){return this.None(e)}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(e){var t=1.70158;return 1===e?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return 0===e?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-P.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*P.Bounce.In(2*e):.5*P.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),O=function(){return performance.now()},E=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=O()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var s=this._tweens[i[n]],a=!t;s&&!1===s.update(e,a)&&!t&&delete this._tweens[i[n]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),B={Linear:function(e,t){var i=e.length-1,n=i*t,s=Math.floor(n),a=B.Utils.Linear;return t<0?a(e[0],e[1],n):t>1?a(e[i],e[i-1],i-n):a(e[s],e[s+1>i?i:s+1],n-s)},Bezier:function(e,t){for(var i=0,n=e.length-1,s=Math.pow,a=B.Utils.Bernstein,o=0;o<=n;o++)i+=s(1-t,n-o)*s(t,o)*e[o]*a(n,o);return i},CatmullRom:function(e,t){var i=e.length-1,n=i*t,s=Math.floor(n),a=B.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(s=Math.floor(n=i*(1+t))),a(e[(s-1+i)%i],e[s],e[(s+1)%i],e[(s+2)%i],n-s)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[i]-(a(e[i],e[i],e[i-1],e[i-1],n-i)-e[i]):a(e[s?s-1:0],e[s],e[i<s+1?i:s+1],e[i<s+2?i:s+2],n-s)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=B.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:(C=[1],function(e){var t=1;if(C[e])return C[e];for(var i=e;i>1;i--)t*=i;return C[e]=t,t}),CatmullRom:function(e,t,i,n,s){var a=.5*(i-e),o=.5*(n-t),r=s*s;return(2*t-2*i+a+o)*(s*r)+(-3*t+3*i-2*a-o)*r+a*s+t}}},I=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),M=new E,F=function(){function e(e,t){void 0===t&&(t=M),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=P.Linear.None,this._interpolationFunction=B.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=I.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=O()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var n={};for(var s in this._valuesEnd)n[s]=this._valuesEnd[s];this._valuesEnd=n}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,i,n,s){for(var a in i){var o=e[a],r=Array.isArray(o),d=r?"array":typeof o,l=!r&&Array.isArray(i[a]);if("undefined"!==d&&"function"!==d){if(l){if(0===(g=i[a]).length)continue;for(var h=[o],u=0,c=g.length;u<c;u+=1){var p=this._handleRelativeValue(o,g[u]);if(isNaN(p)){l=!1,console.warn("Found invalid interpolation list. Skipping.");break}h.push(p)}l&&(i[a]=h)}if("object"!==d&&!r||!o||l)(void 0===t[a]||s)&&(t[a]=o),r||(t[a]*=1),n[a]=l?i[a].slice().reverse():t[a]||0;else{t[a]=r?[]:{};var _=o;for(var f in _)t[a][f]=_[f];n[a]=r?[]:{};var g=i[a];if(!this._isDynamic){var m={};for(var f in g)m[f]=g[f];i[a]=g=m}this._setupProperties(_,t[a],g,n[a],s)}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=O()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=O()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return void 0===e&&(e=M),this._group=e,this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=P.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=B.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=O()),void 0===t&&(t=!0),this._isPaused)return!0;var i,n,s=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>s)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),n=(e-this._startTime)/this._duration,n=0===this._duration||n>1?1:n;var a=this._easingFunction(n);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,r=this._chainedTweens.length;o<r;o++)this._chainedTweens[o].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,i,n){for(var s in i)if(void 0!==t[s]){var a=t[s]||0,o=i[s],r=Array.isArray(e[s]),d=Array.isArray(o);!r&&d?e[s]=this._interpolationFunction(o,n):"object"==typeof o&&o?this._updateProperties(e[s],a,o,n):"number"==typeof(o=this._handleRelativeValue(a,o))&&(e[s]=a+(o-a)*n)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),R=M;R.getAll.bind(R),R.removeAll.bind(R),R.add.bind(R),R.remove.bind(R),R.update.bind(R);class L extends F{update(e,t){return super.update(e,t)}chain(...e){const t=[];return Array.isArray(e)&&e.forEach((e=>{if(e instanceof L)t.push(e);else{const i=L.build(e);i instanceof L&&t.push(i)}})),super.chain(...t)}static build(e,t=!1){if(void 0===e&&(e={target:null}),void 0===e.target&&(e.target=null),void 0===e.duration&&(e.duration=1e3),void 0===e.delay&&(e.delay=0),void 0===e.repeat&&(e.repeat=0),void 0===e.repeatDelay&&(e.repeatDelay=0),void 0===e.yoyo&&(e.yoyo=!1),void 0===e.group&&(e.group=null),void 0===e.easing&&(e.easing=P.Linear.None),void 0===e.interpolation&&(e.interpolation=null),void 0===e.chain&&(e.chain=[]),void 0===e.onStart&&(e.onStart=null),void 0===e.onEveryStart&&(e.onEveryStart=null),void 0===e.onUpdate&&(e.onUpdate=null),void 0===e.onRepeat&&(e.onRepeat=null),void 0===e.onComplete&&(e.onComplete=null),void 0===e.onStop&&(e.onStop=null),void 0===e.start&&(e.start=!0),e.target){const i=new L(e.target,e.group??t);return"object"!=typeof e.to||Array.isArray(e.to)||i.to(e.to),"number"==typeof e.duration&&i.duration(e.duration),"number"==typeof e.delay&&i.delay(e.delay),"number"==typeof e.repeat&&i.repeat(e.repeat),"number"==typeof e.repeatDelay&&i.repeatDelay(e.repeatDelay),"boolean"==typeof e.yoyo&&i.yoyo(e.yoyo),e.group instanceof j&&i.group(e.group),"function"==typeof e.easing&&i.easing(e.easing),"function"==typeof e.interpolation&&i.interpolation(e.interpolation),Array.isArray(e.chain)||(e.chain=[e.chain]),i.chain(...e.chain),"function"==typeof e.onStart&&i.onStart(e.onStart),"function"==typeof e.onEveryStart&&i.onEveryStart(e.onEveryStart),"function"==typeof e.onUpdate&&i.onUpdate(e.onUpdate),"function"==typeof e.onRepeat&&i.onRepeat(e.onRepeat),"function"==typeof e.onComplete&&i.onComplete(e.onComplete),"function"==typeof e.onStop&&i.onStop(e.onStop),!0===e.start&&i.start(),i}return null}}class j extends E{constructor(e){super(),this._isPaused=!1,this._pauseStart=0,this._scene=e,this._scene.on("preupdate",this.update.bind(this))}update(){return!(this._scene.isActive&&!this._isPaused)||super.update()}destroy(){this.removeAll(),this._scene.off("preupdate",this.update.bind(this))}build(e){return L.build(e,this)}add(e){return e instanceof L||(e=this.build(e)),e instanceof L&&super.add(e),e}pause(e=performance.now()){return this._isPaused||(this._isPaused=!0,this._pauseStart=e),this}resume(e=performance.now()){if(!this._isPaused)return this;this._isPaused=!1;const t=e-this._pauseStart,i=this._tweens,n=Object.keys(i),s=n.length;for(let e=0;e<s;e++)i[n[e]]._startTime+=t;return this._pauseStart=0,this}}var H=Object.freeze({__proto__:null,Group:j,Tween:L});class D{static init(e){Object.defineProperty(this,"tween",{set(e){this._tween=e},get(){return this._tween}}),this._tween=null,this.tween=new j(this)}static destroy(){this._tween&&this._tween.destroy()}}function z(e){if(null==e&&(e={}),"object"==typeof(e=r(e,{accessible:!1,accessibleChildren:!0,accessibleHint:void 0,accessiblePointerEvents:"auto",accessibleTitle:void 0,accessibleType:"button",addToParent:!0,alpha:1,anchorX:0,anchorY:0,blendMode:0,buttonMode:!1,children:[],cursor:void 0,filterArea:void 0,hitArea:void 0,height:void 0,identity:"container",interactiveChildren:!0,eventMode:"none",localName:"",name:"",pivotX:0,pivotY:0,renderable:!0,roundPixels:!1,scaleX:1,scaleY:1,skewX:0,skewY:0,tint:16777215,visible:!0,width:void 0,x:0,y:0})).children&&Array.isArray(e.children))for(let t=0;t<e.children.length;t++)e.children[t]=z(e.children[t]);return e}D.extension="scene",s.extensions.add(D);class G{}function N(e,t,i){void 0!==t&&"function"==typeof t.addChild&&("number"==typeof i?t.addChildAt(e,i):t.addChild(e))}function W(e,t,i,n){if(t=z(t),e.accessible=t.accessible,e.accessibleChildren=t.accessibleChildren,e.accessibleHint=t.accessibleHint,e.accessiblePointerEvents=t.accessiblePointerEvents,e.accessibleTitle=t.accessibleTitle,e.accessibleType=t.accessibleType,e.alpha=t.alpha,e.eventMode=t.eventMode,"number"==typeof t.angle&&(e.angle=t.angle),e.cursor=t.cursor,void 0!==t.filterArea){const i=o(t.filterArea,"x",0),n=o(t.filterArea,"y",0),a=o(t.filterArea,"width",0),r=o(t.filterArea,"height",0);e.filterArea=new s.Rectangle(i,n,a,r)}if(void 0!==t.hitArea)switch(t.hitArea.type=o(t.hitArea,"type","rectangle"),t.hitArea.x=o(t.hitArea,"x",0),t.hitArea.y=o(t.hitArea,"y",0),t.hitArea.type){case"circle":t.hitArea.radius=o(t.hitArea,"radius",0),e.hitArea=new s.Circle(t.hitArea.x,t.hitArea.y,t.hitArea.radius);break;case"ellipse":t.hitArea.halfWidth=o(t.hitArea,"halfWidth",0),t.hitArea.halfHeight=o(t.hitArea,"halfHeight",0),e.hitArea=new s.Ellipse(t.hitArea.x,t.hitArea.y,t.hitArea.halfWidth,t.hitArea.halfHeight);break;case"polygon":t.hitArea.points=o(t.hitArea,"points",[]),e.hitArea=new s.Polygon(...t.hitArea.points);break;case"rectangle":t.hitArea.width=o(t.hitArea,"width",0),t.hitArea.height=o(t.hitArea,"height",0),e.hitArea=new s.Rectangle(t.hitArea.x,t.hitArea.y,t.hitArea.width,t.hitArea.height);break;case"roundedrectangle":t.hitArea.width=o(t.hitArea,"width",0),t.hitArea.height=o(t.hitArea,"height",0),t.hitArea.radius=o(t.hitArea,"radius",0),e.hitArea=new s.RoundedRectangle(t.hitArea.x,t.hitArea.y,t.hitArea.width,t.hitArea.height,t.hitArea.radius)}if("number"==typeof t.height&&(e.height=t.height),e.interactiveChildren=t.interactiveChildren,e.identity=t.identity,""!==t.localName&&void 0!==i&&(i[t.localName]=e),e.name=t.name,e.pivot.set(t.pivotX,t.pivotY),e.renderable=t.renderable,"number"==typeof t.rotation&&(e.rotation=t.rotation),e.scale.set(t.scaleX,t.scaleY),e.skew.set(t.skewX,t.skewY),e.visible=t.visible,"number"==typeof t.width&&(e.width=t.width),e.x=t.x,e.y=t.y,t.children.length>0)for(let i=0;i<t.children.length;i++){const n=t.children[i];if(te[n.identity])try{te[n.identity](n,n.addToParent?e:null)}catch(e){console.error("Cannot create game object",e)}else console.error("Object type not registered to display object map")}return void 0!==e.anchor&&e.anchor instanceof s.ObservablePoint&&e.anchor.set(t.anchorX,t.anchorY),void 0!==e.blendMode&&"number"==typeof t.blendMode&&(e.blendMode=t.blendMode),void 0!==e.roundPixels&&"boolean"==typeof t.roundPixels&&(e.roundPixels=t.roundPixels),void 0===e.tint||"string"!=typeof t.tint&&"number"!=typeof t.tint||("string"==typeof t.tint&&(e.tint=new s.Color(String(t.tint)).toNumber()),e.tint=Number(t.tint)),e.config=a(t),N(e,i,n),e}function V(e,t,i){(e=z(e)).identity="animatedsprite",e.speed=e.speed??1,e.loop=e.loop??!1,e.autoPlay=e.autoPlay??!1;const n=[];void 0!==e.textures&&("object"!=typeof e.textures||Array.isArray(e.textures)||(e.textures=d(e.textures)),Array.isArray(e.textures)&&e.textures.forEach((e=>{"string"==typeof e&&(e=s.Texture.from(e)),n.push(e)})));const a=new s.AnimatedSprite(n,e.autoUpdate);return a.animationSpeed=e.speed,a.loop=e.loop,!0===e.autoPlay&&a.play(),W(a,e,t,i)}function U(e,t,i){(e=z(e)).identity="bitmaptext",e.text=e.text??"";const n=new s.BitmapText(e.text,e.style);return n.resolution=e.resolution??s.settings.RESOLUTION,W(n,e,t,i)}function q(e,t,i){return W(new s.Container,e,t,i)}function X(e,t,i){(e=z(e)).identity="graphics";const n=new s.Graphics(e.geometry);if(void 0!==e.shape)switch(e.shape.type=o(e.shape,"type","rectangle"),e.shape.x=o(e.shape,"x",0),e.shape.y=o(e.shape,"y",0),e.shape.fillStyle=o(e.shape,"fillStyle",{}),"string"==typeof e.shape.fillStyle.texture&&(e.shape.fillStyle.texture=s.Texture.from(e.shape.fillStyle.texture)),n.clear(),e.shape.type){case"line":e.shape.x2=o(e.shape,"x2",1),e.shape.y2=o(e.shape,"y2",0),e.shape.lineStyle=o(e.shape,"lineStyle",{}),n.lineStyle(e.shape.lineStyle).moveTo(e.shape.x,e.shape.y).lineTo(e.shape.x2,e.shape.y2);break;case"linetexture":e.shape.x2=o(e.shape,"x2",1),e.shape.y2=o(e.shape,"y2",0),e.shape.lineTextureStyle=o(e.shape,"lineTextureStyle",{}),"string"==typeof e.shape.lineTextureStyle.texture&&(e.shape.lineTextureStyle.texture=s.Texture.from(e.shape.lineTextureStyle.texture)),n.lineTextureStyle(e.shape.lineTextureStyle).moveTo(e.shape.x,e.shape.y).lineTo(e.shape.x2,e.shape.y2);break;case"circle":e.shape.radius=o(e.shape,"radius",0),n.beginTextureFill(e.shape.fillStyle).beginFill(e.shape.fillStyle.color,e.shape.fillStyle.alpha).drawCircle(e.shape.x,e.shape.y,e.shape.radius).endFill();break;case"ellipse":e.shape.width=o(e.shape,"width",1),e.shape.height=o(e.shape,"height",1),n.beginTextureFill(e.shape.fillStyle).beginFill(e.shape.fillStyle.color,e.shape.fillStyle.alpha).drawEllipse(e.shape.x,e.shape.y,e.shape.width,e.shape.height).endFill();break;case"polygon":e.shape.points=o(e.shape,"points",[]),n.beginTextureFill(e.shape.fillStyle).beginFill(e.shape.fillStyle.color,e.shape.fillStyle.alpha).drawPolygon(...e.shape.points).endFill();break;case"rectangle":e.shape.width=o(e.shape,"width",1),e.shape.height=o(e.shape,"height",1),n.beginTextureFill(e.shape.fillStyle).beginFill(e.shape.fillStyle.color,e.shape.fillStyle.alpha).drawRect(e.shape.x,e.shape.y,e.shape.width,e.shape.height).endFill();break;case"roundedrectangle":e.shape.width=o(e.shape,"width",0),e.shape.height=o(e.shape,"height",0),e.shape.radius=o(e.shape,"radius",0),n.beginTextureFill(e.shape.fillStyle).beginFill(e.shape.fillStyle.color,e.shape.fillStyle.alpha).drawRoundedRect(e.shape.x,e.shape.y,e.shape.width,e.shape.height,e.shape.radius).endFill()}return W(n,e,t,i)}function $(e,t,i){(e=z(e)).identity="particlecontainer";return W(new s.ParticleContainer(e.maxSize,e.properties,e.batchSize,e.autoResize),e,t,i)}function Y(e,t,n){if((e=z(e)).identity="spine",void 0===e.spineData)return console.error("spineData needed for spine creation"),null;if("string"==typeof e.spineData){const t=s.Cache.get(e.spineData);t&&(e.spineData=t.spineData)}return W(new i.Spine(e.spineData),e,t,n)}function Q(e,t,i){let n;null==e&&(e={}),("string"==typeof e||e instanceof s.Texture)&&(e={texture:e}),(e=z(e)).identity="sprite",n="string"==typeof e.texture?s.Texture.from(e.texture,e.options):n instanceof s.Texture?e.texture:s.Texture.EMPTY;return W(new s.Sprite(n),e,t,i)}function Z(e,t,i){if((e=z(e)).identity="mesh",void 0===e.geometry)return console.error("geometry needed for mesh creation"),null;if(void 0===e.shader)return console.error("shader needed for mesh creation"),null;return W(new s.Mesh(e.geometry,e.shader,e.state,e.drawMode),e,t,i)}function K(e,t,i){let n;(e=z(e)).identity="ninesliceplane",e.leftWidth=e.leftWidth??10,e.topHeight=e.topHeight??10,e.rightWidth=e.rightWidth??10,e.bottomHeight=e.bottomHeight??10,n="string"==typeof e.texture?s.Texture.from(e.texture,e.options):n instanceof s.Texture?e.texture:s.Texture.EMPTY;return W(new s.NineSlicePlane(n,e.leftWidth,e.topHeight,e.rightWidth,e.bottomHeight),e,t,i)}function J(e,t,i){(e=z(e)).identity="text",e.text=e.text??"";const n=new s.Text(e.text,e.style,e.canvas);return n.resolution=e.resolution??s.settings.RESOLUTION,W(n,e,t,i)}function ee(e,t,i){let n;(e=z(e)).identity="tilingsprite",e.tilingwidth=e.tilingwidth??100,e.tilingheight=e.tilingheight??100,n="string"==typeof e.texture?s.Texture.from(e.texture,e.options):n instanceof s.Texture?e.texture:s.Texture.EMPTY;return W(new s.TilingSprite(n,e.tilingwidth,e.tilingheight),e,t,i)}const te={AddTo:N,Build:W,BuildConfig:z,Create:function(e,t,i){let n=null;switch((e=z(e)).identity){case"animatedsprite":n=V(e,t,i);break;case"bitmaptext":n=U(e,t,i);break;case"container":n=q(e,t,i);break;case"graphics":n=X(e,t,i);break;case"particlecontainer":n=$(e,t,i);break;case"spine":n=Y(e,t,i);break;case"sprite":n=Q(e,t,i);break;case"mesh":n=Z(e,t,i);break;case"ninesliceplane":n=K(e,t,i);break;case"text":n=J(e,t,i);break;case"tilingsprite":n=ee(e,t,i);break;default:"function"==typeof te[e.identity]&&(n=te[e.identity](e,t,i))}return n},AnimatedSprite:V,animatedsprite:V,BitmapText:U,bitmaptext:U,Container:q,container:q,Graphics:X,graphics:X,Mesh:Z,mesh:Z,NineSlicePlane:K,ninesliceplane:K,ParticleContainer:$,particlecontainer:$,Spine:Y,spine:Y,Sprite:Q,sprite:Q,Text:J,text:J,TilingSprite:ee,tilingsprite:ee,GameObjectConfig:G};class ie extends s.Container{constructor(e,t){super(),this.manager=e,this.isBooted=!1,this.isActive=!0,this.isSleeping=!1,this.key=t.key,this.game=e.game,this.name=t.key.toUpperCase(),ie._plugins.forEach((e=>{e.init.call(this,t)}))}buildMap(e){void 0!==e&&("string"==typeof e&&(e=s.Cache.get(e)),"object"==typeof e&&(Array.isArray(e)?e.forEach((e=>{te.Create(e,this)})):te.Create(e,this)))}init(){}async preload(){}create(){}update(e){}resize(){}destroy(e){const t=ie._plugins.slice(0);t.reverse(),t.forEach((e=>{e.destroy.call(this)})),super.destroy(e)}}ie._plugins=[],s.extensions.handleByList("scene",ie._plugins);var ne=Object.freeze({__proto__:null,Scene:ie,SceneDataPlugin:k,SceneManager:x,SceneTweenPlugin:D}),se=Object.freeze({__proto__:null,get ALIGN(){return m},App:S,BuildConfig:z,Data:f,GameObjectConfig:G,GameObjects:te,get ORIENTATION(){return y},Scene:ne,Tweens:H,Utils:u});class ae extends s.Sprite{constructor(e){super(s.Texture.from(e.texture)),this._isDisabled=!1,this._up=e.up,this._enter=e.enter,this._leave=e.up,this._down=e.down,this._disable=e.disable,this._type=e.type,this.on("pointerenter",this.onPointerEvent,this),this.on("pointerleave",this.onPointerEvent,this),this.on("pointerdown",this.onPointerEvent,this),this.on("pointerup",this.onPointerEvent,this),this.cursor="pointer",!1===e.isEnabled?this.disabled():this.enabled()}static Create(e,t,i){(e=z(e)).identity="spritebutton";const n=new ae(e);return e.eventMode=n.eventMode,te.Build(n,e,t,i)}onPointerEvent(e){const t=e.type.replace("pointer","");this.setState(t)}setState(e){const t=this[`_${e}`];"tint"===this._type?this.tint=t:this.texture=s.Texture.from(t)}disabled(){this.eventMode="none",this._isDisabled=!0,this.alpha=.5,this.setState("disable")}enabled(){this.eventMode="dynamic",this._isDisabled=!1,this.alpha=1,this.setState("up")}get isDisabled(){return this._isDisabled}}te.spritebutton=ae.Create,te.SpriteButton=ae.Create;class oe extends s.Container{constructor(e,t){super(),this.isLocked=!1,this._bet=0,this._reserved=0,this._usedChips=[],this._mainChips={},this._chips={},this.scene=e,this.name="BET PANEL VIEW";const i=new s.Graphics;i.name="BET TEXT BACKGROUND",i.beginFill("#1e1e1e",.5).drawRoundedRect(0,0,100,30,7).endFill(),i.position.set(165,-80),this.addChild(i),this._betText=new s.Text("",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:16}),this._betText.anchor.set(.5),this._betText.position.set(50,15),i.addChild(this._betText),this._reservedText=new s.Text("",{fontFamily:"Bungee Regular",fill:"#31cac6",fontSize:16}),this._reservedText.anchor.set(.5),this._reservedText.position.set(80,15),i.addChild(this._reservedText);const n=new ae({texture:"buttons/clean",up:"#ffffff",enter:"#dddddd",down:"#aaaaaa",disable:"#555555",type:"tint"});n.name="BET CLEAR BUTTON",n.position.set(135,-140),n.scale.set(.5),n.anchor.set(.5),this.addChild(n),n.onclick=n.ontap=()=>{!1===this.isLocked&&(this.scene.game.sound.get("button").play(),this.clear())},this._chipPool=new _(this.createChip,this.resetChip,5);let a=0;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const i=t[e],n=this._chipPool.get();n.data.texture=s.Texture.from(e),n.data.scale.set(.5),n.data.x=90*a,n.data.y=-45,n.data.onclick=n.data.ontap=this.increase.bind(this,i),this.addChild(n.data),this._chips[i.toString()]={texture:e,value:i,x:n.data.x,y:0},this._mainChips[i.toString()]=n.data,a++}this.sync(),this.scene.game.data.on("changedata",this.onBalanceChange,this)}sync(){this.bet=this.scene.game.data.get("bet",0),this.reserved=this.scene.game.data.get("reserved",0);const e=this.scene.game.data.get("chips",[]);Array.isArray(e)&&e.forEach((e=>{this.playIncreaseChipAnim(e,!0)})),this.checkChips()}reset(){this.isLocked=!1,this.clear(!0)}clear(e=!1){if(!1===this.isLocked){const t=this._usedChips.length-1;for(let i=t;i>=0;i--)e?this.playDecreaseAnim(i,!0,0):t-i<=5?this.playDecreaseAnim(i,!1,100*(t-i)):this.playDecreaseAnim(i,!0,0);this.scene.game.data.set("chips",[]),this.bet=0,this.checkChips()}}reserve(){!1===this.isLocked&&(this.reserved=this.bet,this.clear())}onBalanceChange(e){"balance"===e&&this.checkChips()}checkChips(){const e=this.scene.game.data.get("balance",0)-this.bet;for(const t in this._mainChips)if(Object.prototype.hasOwnProperty.call(this._mainChips,t)){const i=this._mainChips[t];parseInt(t)>e?i.disabled():i.enabled()}}increase(e){if(!1===this.isLocked){const t=Object.keys(this._chips),i=this.scene.game.data.get("balance",0);if(t.indexOf(e.toString())>-1&&i>=this._bet+e){this.bet+=e,this.checkChips();const t=this.scene.game.data.get("chips",[]);t.push(e),this.scene.game.data.set("chips",t).save(),this.playIncreaseChipAnim(e)}}}playIncreaseChipAnim(e,t=!1){const i=this._chips[e.toString()],n=this._chipPool.get();this._usedChips.push(n),n.data.onclick=n.data.ontap=this.decrease.bind(this,e,this._usedChips.length-1),n.data.texture=s.Texture.from(i.texture),n.data.scale.set(.5),n.data.x=i.x,n.data.y=i.y,this.addChild(n.data),this.scene.tween.add({target:n.data,to:{x:180,y:-175},duration:t?10:300,easing:P.generatePow(3).Out,onStart:e=>{this.scene.game.sound.get("chip").play(),e.eventMode="none"},onComplete:e=>{e.enabled()}})}decrease(e,t){if(!1===this.isLocked){if(Object.keys(this._chips).indexOf(e.toString())>-1&&this._bet>=e){this.bet-=e,this.checkChips();const i=this.scene.game.data.get("chips",[]);i.splice(i.lastIndexOf(e),1),this.scene.game.data.set("chips",i).save(),this.playDecreaseAnim(t)}}}playDecreaseAnim(e,t=!1,i=0){const n=this._usedChips[e];n&&(this._usedChips.splice(e,1),this.scene.tween.add({target:n.data,to:{y:150},delay:i,duration:t?10:300,easing:P.generatePow(3).In,onStart:e=>{this.scene.game.sound.get("chip").play(),e.eventMode="none"},onComplete:()=>{this.removeChild(n.data),this._chipPool.release(n)}}))}createChip(){return ae.Create({texture:"EMPTY",up:"#ffffff",enter:"#dddddd",down:"#aaaaaa",disable:"#555555",type:"tint"},this)}resetChip(e){return e.texture=null,e.onclick=null,e.ontap=null,e.enabled(),e}destroy(){this.scene.game.data.off("changedata",this.onBalanceChange,this)}get bet(){return this._bet}set bet(e){this._bet=e,this.scene.game.data.set("bet",e),this.scene.game.data.save(),this._betText.text=`${this._bet.toString()} `}get reserved(){return this._reserved}set reserved(e){this._reserved=e,this.scene.game.data.set("reserved",e),this.scene.game.data,this._reservedText.text=`${this._reserved.toString()} `,this._reservedText.visible=e>0,this._betText.x=e>0?20:50}}class re extends s.Container{constructor(e){super(),this.subType=null,this.type=null,this.owner=null,this._backSide=null,this._frontSide=null,this._isVisible=!1,this.reset(),this.create(e)}create(e){this.subType=e.subType,this.type=e.type,this.owner=e.owner,null===this._backSide?(this._backSide=new s.Sprite(s.Texture.from(e.back)),this.addChild(this._backSide)):this._backSide.texture=s.Texture.from(e.back),null===this._frontSide?(this._frontSide=new s.Sprite(s.Texture.from(e.front)),this.addChild(this._frontSide)):this._frontSide.texture=s.Texture.from(e.front)}reset(){this.position.set(0),this.scale.set(1),this.pivot.set(0,0),this.alpha=1,this.angle=0,this.subType=null,this.type=null,this.owner=null}open(){this._isVisible=!0,this._backSide.visible=!this._isVisible,this._frontSide.visible=this._isVisible}close(){this._isVisible=!1,this._backSide.visible=!this._isVisible,this._frontSide.visible=this._isVisible}destroy(e){this.reset(),super.destroy(e)}get isVisible(){return this._isVisible}}class de extends s.Container{constructor(e,t){super(),this.isLocked=!1,this.pCards=[],this.dCards=[],this.copies=[],this._cards=[],this._usedCards=[],this.scene=e,this.name="DECK VIEW",this._dCardsC=new s.Container,this._dCardsC.name="DEALER CARDS",this._dCardsC.position.set(88,-20),this._dCardsC.scale.set(.5),this.addChild(this._dCardsC),this._pCardsC=new s.Container,this._pCardsC.name="PLAYER CARDS",this._pCardsC.position.set(88,140),this._pCardsC.scale.set(.75),this.addChild(this._pCardsC),this._options=t,this._cardPool=new _(this.newCard,this.resetCard,8);const i=["a","2","3","4","5","6","7","8","9","10","j","q","k"],n=t.textures,a=t.back;this._cards.length=0,["clubs","spades","diamonds","hearts"].forEach((e=>{i.forEach((t=>{let i=n[e][t];"string"==typeof i&&(i={back:a,front:i}),this._cards.push({back:a,...i,type:e,subType:t,owner:null})}))})),this._cardBelow=new s.Sprite(s.Texture.from(a)),this._cardBelow.anchor.set(.5),this._cardBelow.position.set(100,60),this._cardBelow.zIndex=10,this._cardBelow.visible=!1,this.addChild(this._cardBelow),this._cardAbove=new s.Sprite(s.Texture.from(a)),this._cardAbove.anchor.set(.5),this._cardAbove.position.set(100,60),this._cardAbove.zIndex=20,this._cardAbove.visible=!1,this.addChild(this._cardAbove),this.sync()}sync(){const e=this.scene.game.data.get("dealer",[]),t=this.scene.game.data.get("player",[]);if(e.length>0||t.length>0){this.copies=this.scene.game.data.get("deck",[]);const i=e.concat(t),n=t.length-1,s=e.length-1;let a=0,o=0;i.forEach((e=>{const t=e.isVisible,i=e.owner,r=e.cIndex,d=this._cards[r],l=this._cardPool.get();l.data.create(d),l.data.pivot.set(100),l.data.owner=i,t?l.data.open():l.data.close(),this._usedCards.push(l),"dealer"===i?(this._dCardsC.addChild(l.data),this.dCards.push(l.data),l.data.x=-40*(s-o++),l.data.x<-320&&(l.data.x=-320)):(this._pCardsC.addChild(l.data),this.pCards.push(l.data),l.data.x=-45*(n-a++),l.data.x<-180&&(l.data.x=-180))}))}else this.shuffle()}reset(){this.isLocked=!1,this.relase(!0)}shuffle(e=!1,t=null,i=null){this.copies=[...this._cards],this.scene.game.data.set("deck",[...this.copies]).save(),e?this.playShuffleAnim(t,i):t&&t.call(i)}playShuffleAnim(e=null,t=null){this.scene.tween.add({target:this._cardAbove,to:{x:170},duration:300,yoyo:!0,repeat:9,easing:P.generatePow(2).Out,onStart:()=>{this._cardAbove.visible=!0},onRepeat:()=>{this._cardAbove.zIndex=20===this._cardAbove.zIndex?10:20,this.sortableChildren=!0},onComplete:()=>{this.scene.tween.add({target:this._cardAbove,to:{angle:-30},duration:300,delay:150,onComplete:()=>{this.scene.tween.add({target:this._cardAbove,to:{x:295,y:-80,alpha:0,scale:{x:.5,y:.5}},duration:1e3,delay:250,easing:P.generatePow(2).Out,onComplete:()=>{this._cardAbove.position.set(100,60),this._cardAbove.angle=0,this._cardAbove.alpha=1,this._cardAbove.scale.set(1),this._cardAbove.zIndex=20,this._cardAbove.visible=!1}})}})}}),this.scene.tween.add({target:this._cardBelow,to:{x:30},duration:300,yoyo:!0,repeat:9,easing:P.generatePow(2).Out,onStart:()=>{this._cardBelow.visible=!0},onRepeat:()=>{this._cardBelow.zIndex=20===this._cardBelow.zIndex?10:20,this.sortableChildren=!0},onComplete:()=>{this.scene.tween.add({target:this._cardBelow,to:{angle:-30},duration:300,delay:300,onComplete:()=>{this.scene.tween.add({target:this._cardBelow,to:{x:295,y:-80,alpha:0,scale:{x:.5,y:.5}},duration:1e3,delay:250,easing:P.generatePow(2).Out,onComplete:()=>{this._cardBelow.position.set(100,60),this._cardBelow.angle=0,this._cardBelow.alpha=1,this._cardBelow.scale.set(1),this._cardBelow.zIndex=10,this._cardBelow.visible=!1,this.sortableChildren=!0,e&&e.call(t)}})}})}})}initial(e=null,t=null){!1===this.isLocked&&this.hit(1,"dealer",!0,(()=>{this.hit(1,"player",!0,(()=>{this.hit(1,"dealer",!1,(()=>{this.hit(1,"player",!0,e,t)}),this)}),this)}),this)}hit(e=1,t,i=!0,n=null,s=null){if(!1===this.isLocked){const a=[],o=["clubs","spades","diamonds","hearts"],r=["a","2","3","4","5","6","7","8","9","10","j","q","k"];e=Math.min(e,this.copies.length);for(let d=0;d<e;d++){let e=l(0,this.copies.length-1);const h=this.copies[e],u=this._cardPool.get();u.data.create(h),u.data.alpha=0,u.data.position.set("dealer"===t?380:235,"dealer"===t?-80:-260),u.data.angle=-30,u.data.pivot.set(100),u.data.owner=t,a.push(u),i?u.data.open():u.data.close(),"dealer"===t?this._dCardsC.addChild(u.data):this._pCardsC.addChild(u.data),"dealer"===t?this.dCards.push(u.data):this.pCards.push(u.data);const c=this.scene.game.data.get(`${t}`,[]);c.push({owner:t,type:u.data.type,subType:u.data.subType,isVisible:u.data.isVisible,cIndex:r.indexOf(u.data.subType)+13*o.indexOf(u.data.type)}),this.scene.game.data.set(`${t}`,c).save(),this.copies.splice(e,1),this.scene.game.data.set("deck",[...this.copies]).save();const p="dealer"===t?40:45,_="dealer"===t?-320:-180,f=1,g=-360;this.scene.tween.add({target:u.data,to:{x:0,y:0,angle:g,alpha:f},delay:250*(d+1),duration:300,onStart:()=>{this.scene.game.sound.get("card-pick").play()},onComplete:e=>{const t=[...("dealer"===e.owner?this._dCardsC:this._pCardsC).children];t.splice(t.indexOf(e),1),t.forEach((e=>{e.x>=_&&(e.x-=p)})),n&&n.call(s)}})}return this._usedCards.push(...a),a}return null}relase(e=!1){!1===this.isLocked&&(this.scene.tween.add({target:this._dCardsC,to:{x:-200,alpha:0},duration:e?10:1e3,easing:P.Back.In,onComplete:()=>{this.scene.game.data.set("dealer",[]).save()}}),this.scene.tween.add({target:this._pCardsC,to:{x:-200,alpha:0},duration:e?10:1e3,delay:e?0:100,easing:P.Back.In,onComplete:()=>{this.scene.game.data.set("player",[]).save(),this._usedCards.forEach((e=>{this._cardPool.release(e)})),this._usedCards.length=0,this._dCardsC.removeChildren(),this._dCardsC.position.set(88,-20),this._dCardsC.alpha=1,this._pCardsC.removeChildren(),this._pCardsC.position.set(88,140),this._pCardsC.alpha=1}}),this.pCards.length=0,this.dCards.length=0)}newCard(){return new re({back:"EMPTY",front:"EMPTY",type:null,subType:null,owner:null})}resetCard(e){return e.reset(),e}get remains(){return this.copies.length}}class le extends s.Container{constructor(e){super(),this.isLocked=!1,this._total=0,this.scene=e,this.name="WALLET VIEW";const t=new s.Graphics;t.name="WALLET BACKGROUND",t.beginFill("#1e1e1e",.5).drawRoundedRect(0,0,200,30,7).endFill(),this.addChild(t),this._coinAnimPool=new _(this.createCoinAnim,this.resetCoinAnim,10);const i=this._coinAnimPool.get();i.data.visible=!0,i.data.animationSpeed=.25,i.data.loop=!0,i.data.scale.set(.25),i.data.play(),i.data.position.set(5,5),this.addChild(i.data),this._totalText=new s.Text(`${this._total} `,{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:16}),this._totalText.position.set(40,5),this.addChild(this._totalText),this._amountText=new s.Text("",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:16,align:"right"}),this._amountText.position.set(150,5),this.addChild(this._amountText),this.sync()}sync(){this.isLocked=!1,this._total=this.scene.game.data.get("balance",1e3),this._totalText.text=`${this._total} `}reset(){this.resetTweens(),this._total=0,this._totalText.text=`${this._total} `}resetTweens(){this._valueTween&&this._valueTween.isPlaying&&(this._valueTween.end(),this.scene.tween.remove(this._valueTween)),this._amountTween&&this._amountTween.isPlaying&&(this._amountTween.end(),this.scene.tween.remove(this._amountTween)),this._amountText.text=""}createCoinAnim(){const e=[s.Texture.from("coins/00000"),s.Texture.from("coins/00001"),s.Texture.from("coins/00002"),s.Texture.from("coins/00003"),s.Texture.from("coins/00004"),s.Texture.from("coins/00005"),s.Texture.from("coins/00006")];return new s.AnimatedSprite(e)}resetCoinAnim(e){return e.animationSpeed=1,e.loop=!1,e.scale.set(1),e.stop(),e.position.set(0,0),e.visible=!1,e}deposit(e,t=!1){!1===this.isLocked&&(this.playAnim(this.total+e,t),t||this.playCoinAnim(e),this._total+=e,this.scene.game.data.set("balance",this._total).save())}withdraw(e,t=!1){return!(this.isLocked||e>this.total)&&(this.playAnim(this.total-e,t),this._total-=e,this.scene.game.data.set("balance",this._total).save(),!0)}playAnim(e,t=!1){this.resetTweens();const i={value:this.total},n=e-this.total;let s=Math.abs(Math.round(n/10));s=Math.min(s,10),this._amountText.style.fill=n>0?"#ffd700":"#c00707",this._amountText.text=n.toString(),this._valueTween=this.scene.tween.add({target:i,to:{value:e},duration:t?10:300*s,delay:250,onUpdate:e=>{this._totalText.text=`${Math.round(e.value).toString()} `}}),this._amountTween=this.scene.tween.add({target:{value:n},to:{value:0},duration:t?10:300*s,delay:250,onUpdate:e=>{this._amountText.text=`${Math.round(e.value).toString()}`},onComplete:()=>{this._amountText.text=""}})}playCoinAnim(e){const t=Math.min(e,20);for(let e=0;e<t;e++){const t=l(150,250),i=l(320,420),n=this._coinAnimPool.get();n.data.position.set(t,i),n.data.scale.set(.75),this.scene.tween.add({target:n.data,to:{x:0,y:0},duration:500,delay:100*e,onStart:()=>{n.data.visible=!0,n.data.animationSpeed=.5,n.data.loop=!0,n.data.play(),this.addChild(n.data)},onComplete:()=>{this.scene.game.sound.get("coin").play(),this.removeChild(n.data),this._coinAnimPool.release(n)}})}}get total(){return this._total}}var he=Object.freeze({__proto__:null,BetPanel:oe,Card:re,Deck:de,SpriteButton:ae,Wallet:le});const ue=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],ce=(()=>{if("undefined"==typeof document)return!1;const e=ue[0],t={};for(const i of ue){const n=i?.[1];if(n in document){for(const[n,s]of i.entries())t[e[n]]=s;return t}}return!1})(),pe={change:ce.fullscreenchange,error:ce.fullscreenerror};let _e={request:(e=document.documentElement,t)=>new Promise(((i,n)=>{const s=()=>{_e.off("change",s),i()};_e.on("change",s);const a=e[ce.requestFullscreen](t);a instanceof Promise&&a.then(s).catch(n)})),exit:()=>new Promise(((e,t)=>{if(!_e.isFullscreen)return void e();const i=()=>{_e.off("change",i),e()};_e.on("change",i);const n=document[ce.exitFullscreen]();n instanceof Promise&&n.then(i).catch(t)})),toggle:(e,t)=>_e.isFullscreen?_e.exit():_e.request(e,t),onchange(e){_e.on("change",e)},onerror(e){_e.on("error",e)},on(e,t){const i=pe[e];i&&document.addEventListener(i,t,!1)},off(e,t){const i=pe[e];i&&document.removeEventListener(i,t,!1)},raw:ce};Object.defineProperties(_e,{isFullscreen:{get:()=>Boolean(document[ce.fullscreenElement])},element:{enumerable:!0,get:()=>document[ce.fullscreenElement]??void 0},isEnabled:{enumerable:!0,get:()=>Boolean(document[ce.fullscreenEnabled])}}),ce||(_e={isEnabled:!1});var fe=_e;var ge=Object.freeze({__proto__:null,BackgroundScene:class extends ie{init(){s.utils.isMobile.phone&&fe.isEnabled&&fe.request()}create(){const e=this.game.data.get("music",!1);this._music=this.game.sound.get("main-music"),this._music.volume(.5),this._music.loop(!0),!0===e&&this.game.sound.get("main-music").play()}onMuteClick(){const e=this.game.data.get("music",!1);!0===e?this._music.pause():this._music.play(),this.game.data.set("music",!e).save()}},GameScene:class extends ie{constructor(){super(...arguments),this._sessionID=0,this._pScores=[0],this._dScores=[0]}init(){this._sessionID=this.game.data.get("sessionID",-1),this.on("wokeup",this.onWokeUp,this)}create(){const e=s.Cache.get("blackjack"),t=new s.Graphics;t.name="DEALER SCORE",t.beginFill("#1e1e1e",.5).drawRoundedRect(0,0,50,20,4).endFill(),t.position.set(620,200),this.addChild(t),this._dScoreText=new s.Text("0",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:12,align:"center"}),this._dScoreText.anchor.set(.5),this._dScoreText.position.set(25,9),t.addChild(this._dScoreText);const i=new s.Graphics;i.name="PLAYER SCORE",i.beginFill("#1e1e1e",.5).drawRoundedRect(0,0,50,20,4).endFill(),i.position.set(620,380),this.addChild(i),this._pScoreText=new s.Text("0",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:12,align:"center"}),this._pScoreText.anchor.set(.5),this._pScoreText.position.set(25,9),i.addChild(this._pScoreText),this._homeButton.onclick=this._homeButton.ontap=this.onHomeClick.bind(this),this._betP=new oe(this,e.chips),this._betP.position.set(425,600),this.addChild(this._betP),this._deck=new de(this,e.deck),this._deck.position.set(550,170),this.addChild(this._deck),this._dealButton.onclick=this._dealButton.ontap=this.onDeal.bind(this),this._hitButton.onclick=this._hitButton.ontap=this.onHit.bind(this),this._standButton.onclick=this._standButton.ontap=this.onStand.bind(this),this._blackBack=new s.Graphics,this._blackBack.visible=!1,this._blackBack.alpha=0,this._blackBack.name="BLACK BACKGROUND",this._blackBack.beginFill("#000000",.7).lineStyle({width:5}).drawRect(0,0,1280,720).endFill(),this._blackBack.eventMode="dynamic",this.addChild(this._blackBack),this._wallet=new le(this),this._wallet.position.set(425,70),this.addChild(this._wallet),this._resultText=new s.Text("PUSH",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:100,align:"center",wordWrap:!0,breakWords:!0,wordWrapWidth:400}),this._resultText.name="RESULT TEXT",this._resultText.visible=!1,this._resultText.alpha=0,this._resultText.scale.set(0),this._resultText.anchor.set(.5),this._resultText.position.set(640,360),this.addChild(this._resultText),this._popup=new s.Graphics,this._popup.visible=!1,this._popup.alpha=0,this._popup.name="POPUP BACKGROUND",this._popup.beginFill("#000000",1).lineStyle({width:5}).drawRoundedRect(0,0,300,200,10).endFill(),this._popup.position.set(490,140),this.addChild(this._popup);const n=new s.Text("Not enough money!",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:24,align:"center",wordWrap:!0,breakWords:!0,wordWrapWidth:250});n.position.set(70,50),this._popup.addChild(n);const a=new ae({texture:"buttons/start",up:"#ffffff",enter:"#dddddd",down:"#aaaaaa",disable:"#555555",type:"tint"});a.anchor.set(.5),a.scale.set(.35),a.position.set(60,165);const o=new s.Text("+1000 ",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:40,align:"center"});o.position.set(-88,-22),a.onclick=a.ontap=()=>{this.game.sound.get("button").play(),this._wallet.deposit(1e3),this.setState("deal"),this.closePopup()},a.addChild(o),this._popup.addChild(a);const r=new ae({texture:"buttons/stand",up:"#ffffff",enter:"#dddddd",down:"#aaaaaa",disable:"#555555",type:"tint"});r.anchor.set(.5),r.scale.set(.35),r.position.set(150,165);const d=new s.Text("RESET",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:40,align:"center"});d.position.set(-88,-22),r.onclick=r.ontap=()=>{this.game.sound.get("button").play(),this.closePopup(),this.game.data.clear(!0),this.game.scene.start("MenuScene"),this.game.scene.sleep(this.key)},r.addChild(d),this._popup.addChild(r);const l=new ae({texture:"buttons/hit",up:"#ffffff",enter:"#dddddd",down:"#aaaaaa",disable:"#555555",type:"tint"});l.anchor.set(.5),l.scale.set(.35),l.position.set(240,165);const h=new s.Text("CANCEL",{fontFamily:"Bungee Regular",fill:"#ffffff",fontSize:40,align:"center"});h.position.set(-88,-22),l.onclick=l.ontap=()=>{this.game.sound.get("button").play(),this.closePopup()},l.addChild(h),this._popup.addChild(l),this.setState(this.game.data.get("state","deal"))}showPopup(){this._blackBack.visible=!0,this._blackBack.alpha=1,this._popup.visible=!0,this._popup.alpha=1}closePopup(){this._blackBack.visible=!1,this._blackBack.alpha=0,this._popup.visible=!1,this._popup.alpha=0}calculateScore(e){let t=0,i=0;e.forEach((e=>{!1!==e.isVisible&&(["k","q","j"].indexOf(e.subType)>-1?t+=10:"a"===e.subType?(t+=11,i++):t+=parseInt(e.subType))}));let n=[t];for(let e=0;e<i;e++)n.push(t-10*(e+1));const s=n.filter((e=>e<=21));return s.length>0?[...s]:[Math.min(...n)]}checkCards(){const e=this.game.data.get("state","deal");"hit"===e&&(this._pScores=this.calculateScore(this.game.data.get("player",[])),this._pScoreText.text=this._pScores.toString().replace(",","/"),this.checkResult()),"stand"!==e&&"hit"!==e||(this._dScores=this.calculateScore(this.game.data.get("dealer",[])),this._dScoreText.text=this._dScores.toString().replace(",","/"),this.checkResult())}checkResult(){const e=this.game.data.get("state","deal");if("hit"===e){for(let e=0;e<this._pScores.length;e++)if(this._pScores[e]>=21){this._pScores=[this._pScores[e]],this.checkAdditionBet();break}}else if("stand"===e){let e=!1;for(let t=0;t<this._dScores.length;t++)if(this._dScores[t]>21||this._dScores[t]>=this._pScores[0]&&this._dScores[t]<=21||this._pScores[0]>=21&&this._dScores[t]<=21){this._dScores=[this._dScores[t]],this.setState("finished"),e=!0;break}e||this.playForDealer()}}checkAdditionBet(){this._betP.bet>0&&!this._wallet.withdraw(this._betP.bet)?this.showPopup():this.setState("stand")}playForDealer(){if(this.game.data.get("revealed",!1))this._deck.hit(1,"dealer",!0,this.checkCards,this);else{this.game.data.set("revealed",!0),this._deck.dCards[1].open();const e=this.game.data.get("dealer",[]);e[1].isVisible=!0,this.game.data.set("dealer",e),this.checkCards()}}decideNextMove(){const e=this.game.data.get("state","deal");if("finished"===e){const e=this._pScores[0],t=this._dScores[0];let i="push";e>t?i=e<21?"win":e>21?"bust":"blackjack":e<t&&(i=t<=21?"lose":"win"),this.playResult(i)}else"noMoney"===e&&this.showPopup()}playInitialCards(){this._deck.initial((()=>{this.setState("hit"),this.checkCards()}),this)}playResult(e){this.tween.add({target:this._resultText,to:{scale:{x:1,y:1},alpha:1},duration:1e3,delay:500,easing:P.Back.Out,onStart:()=>{if("win"===e||"blackjack"===e||"push"===e){this.game.sound.get("win").play(),"blackjack"===e&&this.game.sound.get("blackjack").play();const t="win"===e?2:"blackjack"===e?3:1,i=this._betP.bet+this._betP.reserved;console.log(i,t),this._wallet.deposit(i*t)}else this.game.sound.get("lose").play();this._betP.isLocked=!1,this._deck.isLocked=!1,this._betP.reserved=0,this._betP.clear(),this._deck.relase(),this._resultText.text=e.toUpperCase(),this._resultText.visible=!0,this._blackBack.visible=!0,this._blackBack.alpha=1},onComplete:()=>{this.tween.add({target:this._resultText,to:{scale:{x:0,y:0},alpha:0},duration:1e3,delay:1500,easing:P.Back.In,onComplete:()=>{this._resultText.visible=!1,this._blackBack.visible=!1,this._blackBack.alpha=0,this.setState("deal")}})}})}onDeal(){this.game.sound.get("button").play(),this._wallet.total>0&&this._wallet.total>=this._betP.bet?this._betP.bet>0&&this._wallet.withdraw(this._betP.bet)?(this._betP.isLocked=!1,this._betP.reserve(),this._dealButton.disabled(),this._deck.copies.length<=26?this._deck.shuffle(!0,this.playInitialCards,this):this.playInitialCards()):this.setState("deal"):this.setState("noMoney")}onHit(){this.game.sound.get("button").play(),this._deck.hit(1,"player",!0,this.checkCards,this)}onStand(){this.game.sound.get("button").play();const e=this._pScores.filter((e=>e<=21));this._pScores=[Math.max(...e)],this.checkAdditionBet()}setState(e){switch(this.game.data.set("state",e).save(),e){case"deal":this._wallet.total>0?(this._hitButton.disabled(),this._standButton.disabled(),this._dealButton.enabled(),this._betP.isLocked=!1,this._deck.isLocked=!1,this._betP.clear(),this._deck.relase(),this._pScoreText.text="0",this._dScoreText.text="0",this._pScores=[0],this._dScores=[0],this.game.data.set("revealed",!1)):this.setState("noMoney");break;case"hit":this._hitButton.enabled(),this._standButton.enabled(),this._dealButton.disabled(),this._deck.isLocked=!1,this.checkCards();break;case"stand":this._hitButton.disabled(),this._standButton.disabled(),this._dealButton.disabled(),this._betP.isLocked=!0,this.playForDealer();break;case"finished":this._hitButton.disabled(),this._standButton.disabled(),this._dealButton.disabled(),this._betP.isLocked=!0,this._deck.isLocked=!0,this._pScoreText.text=this._pScores[0].toString(),this._dScoreText.text=this._dScores[0].toString(),this.decideNextMove();break;case"noMoney":this._hitButton.disabled(),this._standButton.disabled(),this._dealButton.disabled(),this._betP.isLocked=!0,this._deck.isLocked=!0,this.decideNextMove()}}onHomeClick(){this.game.sound.get("button").play(),this.game.scene.sleep(this.key),this.game.scene.start("MenuScene")}onWokeUp(){const e=this.game.data.get("sessionID",-1),t=this.game.data.get("state","deal");this._sessionID!==e?(this._sessionID=e,this._pScoreText.text="0",this._dScoreText.text="0",this._wallet.reset(),this._wallet.sync(),this._betP.reset(),this._betP.sync(),this._deck.reset(),this._deck.sync(),this.setState(t)):"noMoney"===t&&this.showPopup()}},LoadingScene:class extends ie{create(){s.Assets.addBundle("initial-assets",[{name:"Bungee Regular",srcs:"fonts/bungee-regular.ttf"},{name:"spritesheet",srcs:"sprites/sprites.json"}]),s.Assets.loadBundle("initial-assets",this.onProgress.bind(this)).then(this.onAssetLoadComplete.bind(this))}onProgress(e){const t=this._loadingBar.config;this._loadingBar.lineStyle(t.shape.lineStyle).moveTo(0,0).lineTo(t.shape.width*e,0)}registerSounds(){this.game.sound.add("blackjack",{src:"sounds/blackjack.webm"}),this.game.sound.add("button",{src:"sounds/button.webm"}),this.game.sound.add("card-pick",{src:"sounds/card-pick.webm"}),this.game.sound.add("chip",{src:"sounds/chip.webm"}),this.game.sound.add("coin",{src:"sounds/coin.webm"}),this.game.sound.add("main-music",{src:"sounds/main-music.webm"}),this.game.sound.add("win",{src:"sounds/win.webm"}),this.game.sound.add("lose",{src:"sounds/lose.webm"})}onAssetLoadComplete(){this.registerSounds(),this.game.scene.start("BackgroundScene"),this.game.scene.start("MenuScene"),this.game.scene.stop("LoadingScene")}},MenuScene:class extends ie{init(){this.game.data.hasLocalRecord()||this.resetSession(),this.game.data.load(),this.on("wokeup",this.onWokeUp,this)}create(){this._startButton.onclick=this._startButton.ontap=this.onStartClick.bind(this),this._resetButton.onclick=this._resetButton.ontap=this.onResetClick.bind(this),this.checkButtons()}resetSession(){const e=this.game.data.get("music",!0);this.game.data.set("sessionID",s.utils.uid()),this.game.data.set("started",!1),this.game.data.set("state","deal"),this.game.data.set("balance",1e3),this.game.data.set("reserved",0),this.game.data.set("bet",0),this.game.data.set("chips",[]),this.game.data.set("deck",[]),this.game.data.set("revealed",!1),this.game.data.set("dealer",[]),this.game.data.set("player",[]),this.game.data.set("music",e),this.game.data.set("statistic.win",0),this.game.data.set("statistic.lost",0),this.game.data.set("statistic.draw",0),this.game.data.set("statistic.history",[]),this.game.data.set("statistic.total.win",0),this.game.data.set("statistic.total.lost",0),this.game.data.save()}checkButtons(){const e=this.game.data.get("started",!1);this._startButton._label.text=e?"RESUME":"START",this._resetButton.visible=e}onSleep(){this._startButton.disabled()}onWokeUp(){this.game.data.hasLocalRecord()||this.resetSession(),this._startButton.enabled(),this.checkButtons()}onStartClick(){this.game.sound.get("button").play(),this.game.data.set("started",!0).save(),this.game.scene.sleep(this.key),this.game.scene.start("GameScene")}onResetClick(){this.game.sound.get("button").play(),this.resetSession(),this.checkButtons()}}});function me(e){const t=new s.Application(e);(globalThis.document.getElementById("game")||globalThis.document.body).appendChild(t.view),!0===e.debug&&(globalThis.__PIXI_APP__=t,globalThis.game=t)}var ye=Object.freeze({__proto__:null,Components:he,Init:me,Scenes:ge});return window.onload=()=>{s.Assets.load({src:"misc/game.json",loadParser:"loadJson"}).then((e=>{me(e)}))},e.Engine=se,e.Game=ye,e}({},PIXI,PIXI.spine);
